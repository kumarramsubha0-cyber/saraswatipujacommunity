<!DOCTYPE html>
<html lang="hi">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Saraswati Puja App</title>

<style>
*{box-sizing:border-box;font-family:Segoe UI,sans-serif}
body{margin:0;background:#000;display:flex;justify-content:center}

.phone{
 width:390px;height:780px;
 background:linear-gradient(180deg,#f7d87c,#fff6d5);
 border-radius:40px;overflow:hidden;position:relative;
 box-shadow:0 0 40px rgba(0,0,0,.7)
}
header{text-align:center;padding:14px}
h1{margin:0;color:#7b3f00}

.screen{height:640px;padding:10px}
.page{display:none;height:100%;overflow:auto}
.page.active{display:block}

.apps{
 display:grid;
 grid-template-columns:repeat(2,1fr);
 gap:18px;margin-top:20px
}
.app{
 background:#fff;border-radius:22px;
 padding:16px;text-align:center;
 box-shadow:0 10px 25px rgba(0,0,0,.25);
 cursor:pointer
}
.icon{
 width:60px;height:60px;margin:auto;
 border-radius:50%;
 background:linear-gradient(145deg,#ff9800,#ff5722);
 display:flex;align-items:center;justify-content:center;
 font-size:26px;color:#fff
}

input,button{
 width:100%;padding:12px;margin:8px 0;
 border-radius:12px;border:1px solid #ccc
}
button{
 background:#ff5722;color:#fff;
 border:none;font-size:16px;cursor:pointer
}
.paybtn{background:#1aa260}
.back{font-weight:bold;color:#7b3f00;cursor:pointer}

.receipt{
 background:#fff;padding:12px;
 border-radius:12px;margin-top:10px
}

.bottom{
 position:absolute;bottom:0;left:0;right:0;
 height:60px;background:#fff;
 display:flex;justify-content:space-around;align-items:center
}
.bottom div{font-size:13px;cursor:pointer}

.warn{color:red;font-size:12px;text-align:center}
.admin{
 background:#111;color:#fff;
 padding:10px;border-radius:12px
}
table{width:100%;font-size:12px;border-collapse:collapse}
td,th{border:1px solid #555;padding:4px;text-align:center}
.ok{color:#4caf50}
</style>
</head>

<body>
<div class="phone">

<header>
<h1>üôè Saraswati Puja üôè</h1>
</header>

<div class="screen">

<!-- HOME -->
<div class="page active" id="home">
 <div class="apps">
  <div class="app" onclick="openPage('puja')"><div class="icon">üéµ</div>Puja</div>
  <div class="app" onclick="openPage('card')"><div class="icon">ü™î</div>Card</div>
  <div class="app" onclick="openPage('pay')"><div class="icon">‚Çπ</div>Payment</div>
  <div class="app" onclick="openPage('receiptSearch')"><div class="icon">üßæ</div>Receipt</div>
  <div class="app" onclick="openPage('adminLogin')"><div class="icon">üîê</div>Admin</div>
 </div>
</div>

<!-- PUJA -->
<div class="page" id="puja">
<p class="back" onclick="goHome()">‚¨Ö Home</p>
<audio controls autoplay loop style="width:100%">
 <source src="puja-song.m4a">
</audio>
</div>

<!-- CARD -->
<div class="page" id="card">
<p class="back" onclick="goHome()">‚¨Ö Home</p>
<img src="photo.jpg" style="width:100%;border-radius:18px">
</div>

<!-- PAYMENT -->
<div class="page" id="pay">
<p class="back" onclick="goHome()">‚¨Ö Home</p>

<p id="pcWarn" class="warn"></p>

<input id="donor" placeholder="Your Name">
<input id="amount" type="number" placeholder="Amount ‚Çπ250‚Äì‚Çπ5000" oninput="showQR()">

<div id="qrBox" style="display:none;text-align:center">
 <p><b>Scan & Pay</b></p>
 <img id="qrImg" style="width:100%;max-width:260px">
 <button class="paybtn" onclick="openUPI()">üì≤ Pay Now</button>
</div>

<button onclick="startPayment()">I Have Paid</button>
</div>

<!-- SUCCESS -->
<div class="page" id="success">
<h3>‚è≥ Payment Pending Verification</h3>
<div id="receiptBox" class="receipt"></div>
</div>

<!-- RECEIPT SEARCH -->
<div class="page" id="receiptSearch">
<p class="back" onclick="goHome()">‚¨Ö Home</p>
<input id="searchName" placeholder="Name">
<input id="searchAmt" placeholder="Amount">
<button onclick="searchReceipt()">Search</button>
</div>

<!-- ADMIN LOGIN -->
<div class="page" id="adminLogin">
<p class="back" onclick="goHome()">‚¨Ö Home</p>
<input id="apass" type="password" placeholder="Admin Password">
<button onclick="adminLogin()">Login</button>
</div>

<!-- ADMIN PANEL -->
<div class="page" id="adminPanel">
<p class="back" onclick="goHome()">‚¨Ö Home</p>
<div class="admin">
<h3>üìä Admin Dashboard</h3>
<p id="total"></p>
<table id="tbl">
<tr><th>Txn</th><th>Name</th><th>‚Çπ</th><th>Status</th><th>‚úî</th></tr>
</table>
</div>
</div>

</div>

<div class="bottom">
<div onclick="goHome()">üè† Home</div>
<div onclick="openPage('pay')">‚Çπ Pay</div>
<div onclick="openPage('adminLogin')">üîê Admin</div>
</div>

</div>

<script>
/* ===== CONFIG ===== */
const SCRIPT_URL="https://script.google.com/macros/s/AKfycbwGDtbbeF4yyao_WKysSJxcwbtFF8D_s1VFA4kCEVLgtqyfByWW22F9TgHE2aqRJQTs/exec";
const ADMIN_PASS="875719";
const UPI_ID="9471418396@ptyes";
const IS_MOBILE=/Android|iPhone/i.test(navigator.userAgent);

if(!IS_MOBILE){
 pcWarn.innerText="‚ö†Ô∏è Payment sirf mobile phone par kaam karta hai";
}

function openPage(id){
 document.querySelectorAll(".page").forEach(p=>p.classList.remove("active"));
 document.getElementById(id).classList.add("active");
 if(id==="adminPanel") loadData();
}
function goHome(){openPage("home")}
function txnId(){return "PUJA-"+Date.now()}

let CURRENT_UPI="";

/* ===== PAYMENT ===== */
function showQR(){
 let a=Number(amount.value);
 if(a>=250 && a<=5000){
  qrBox.style.display="block";
  let upi=`upi://pay?pa=${UPI_ID}&pn=Saraswati%20Puja&am=${a}&cu=INR`;
  qrImg.src="https://api.qrserver.com/v1/create-qr-code/?size=300x300&data="+encodeURIComponent(upi);
  CURRENT_UPI=upi;
 }else{
  qrBox.style.display="none";
  CURRENT_UPI="";
 }
}

function openUPI(){
 if(!IS_MOBILE){alert("Mobile use kare");return}
 if(!CURRENT_UPI){alert("Valid amount dijiye");return}
 window.location.href=CURRENT_UPI;
}

function startPayment(){
 let n=donor.value,a=+amount.value;
 if(!n||a<250||a>5000){alert("Invalid details");return}
 let txn=txnId();
 fetch(SCRIPT_URL,{
  method:"POST",
  headers:{"Content-Type":"application/json"},
  body:JSON.stringify({
   txn,name:n,amount:a,
   time:new Date().toLocaleString(),
   status:"PENDING"
  })
 });
 receiptBox.innerHTML=`Txn: ${txn}<br>Name: ${n}<br>Amount: ‚Çπ${a}`;
 openPage("success");
}

/* ===== ADMIN ===== */
function searchReceipt(){
 fetch(SCRIPT_URL+"?admin=true")
 .then(r=>r.json())
 .then(d=>{
  let rcp=d.find(x=>x.name===searchName.value && x.amount==searchAmt.value);
  if(rcp){
   receiptBox.innerHTML=`Txn: ${rcp.txn}<br>Name: ${rcp.name}<br>‚Çπ${rcp.amount}<br>${rcp.status}`;
   openPage("success");
  }else alert("No record found");
 });
}

function adminLogin(){
 if(apass.value===ADMIN_PASS) openPage("adminPanel");
 else alert("Wrong password");
}

function loadData(){
 tbl.innerHTML="<tr><th>Txn</th><th>Name</th><th>‚Çπ</th><th>Status</th><th>‚úî</th></tr>";
 fetch(SCRIPT_URL+"?admin=true")
 .then(r=>r.json())
 .then(d=>{
  let sum=0;
  d.forEach(x=>{
   if(x.status==="VERIFIED") sum+=Number(x.amount);
   tbl.innerHTML+=`
   <tr>
    <td>${x.txn}</td>
    <td>${x.name}</td>
    <td>${x.amount}</td>
    <td class="${x.status==="VERIFIED"?"ok":""}">${x.status}</td>
    <td>${x.status==="PENDING"?`<button onclick="verify('${x.txn}')">‚úî</button>`:""}</td>
   </tr>`;
  });
  total.innerText="Total Verified ‚Çπ "+sum;
 });
}

function verify(id){
 fetch(SCRIPT_URL+"?verify="+id).then(loadData);
}
</script>

</body>
</html>
